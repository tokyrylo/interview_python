# Міграції

Міграції у Django - це механізм, який дозволяє вам автоматично створювати та сінхронізувати структуру у бази даних з моделямі Django проекту.
Ось основні аспекти роботи з міграціями Django:

***1. Створення міграцій***
Міграції генеруються за допомогою команди `makemigrations`.
**Команда:**

```bash 
python manage.py makemigrations
```

***2. Застосування міграцій***
**Команда для застосування міграцій**

```bash
python manage.py migrate 
```
Ця команда застосовує міграцій

***3. Структура міграцій***
Міграції зберігаються в каталозі `migrations` кожного додатку. Структура міграцій виглядає так:

```python
from django.db import migrations, models 


class Migration(migrations.Migration):
  dependencies = [
    ("app_name", "0001_initial"),
  ]

  operations = [
    migrations.AddField(
      model_name="model_name",
      name="new_field",
      field=models.CharField(max_length=255, default=""),
    ),
  ]
```
 - `dependencies` - список попередніх міграцій, від яких залежить ця міграція.
 - `operations` - список операцій, які повинні бути виконані. Це можуть бути додавання або зміна полів, створення таблиць тощо.

***4. Як працюють операції в міграціями:***
Міграції можуть містити різні операції для зміни структури бази даних:

 - `AddField` - додає нове поле до моделі.
 - `RemoveField` - видає поле.
 - `AlterField` - змінює властивості поля (наприклад, змінює тип поля або додає нові параметри).
 - `CreateModel` - створює нову модель (таблицю).
 - `DeleteModel` - видаляє модель (таблицю).
 - `AddIndex` - додає індекс до таблиці.

***5. Управління міграціями:***

 - `python manage.py showmigrations` - показує список усіх міграцій для вашого проєкту і чи були вони застосовані.
 - `python manage.py migrate app_name` - застосовує міграції лише для конкретного додатку.
 - `python manage.py migrate app_name 0001` - повертає базу даних до конкретної міграції.
 - `python manage.py sqlmigrate app_name migration_name` - генрує SQL-код для конкретної міргації, без її застосування.

***6. Як повернути міграції назад:***

Якщо треба скасувати застосовані міграції, ви можете виконати команду:

```bash 
python manage.py migrate app_name <migration_name>
```

Це поверне вашу базу до стану, визначеного в зазначеній міграції.

***7. Як об'єднати міграції:***

Іноді, коли в розробці працює кілька розробників, можуть виникнути конфлікти між міграціями. У таких випадках можна об'єднати декілька міграцій в одну:

```bash
python manage.py makemigrations --merge 
```
***8. Робота з кастомними міграціями:***

Також можна створювати власні кастомні операції в міграціях, наприклад, для заповнення бази даних або виконання іншого коду під час застосування міграцій.

***9. Міграції та дані:***

При застосуванні міграцій можуть бути й операції, які змінюють структуру даних. Наприклад:

 - Якщо ви додаєте нове поле, ви можете зазначити значення за замовчуванням.
 - Якщо ви змінюєте тип поля, Django спробує автоматично адаптувати значення в існуючих записах.

Однак, у складних випадках вам може знадобитися вручну написати код для перетворення даних у міграціях.
